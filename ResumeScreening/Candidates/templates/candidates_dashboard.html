<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candidate Dashboard</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .sidebar {
            width: 250px;
            height: 100vh;
            background: #2c3e50;
            color: white;
            padding-top: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: fixed;
            left: 0;
            top: 0;
        }
        .sidebar a {
            width: 100%;
            padding: 15px;
            text-align: center;
            color: white;
            text-decoration: none;
            font-size: 18px;
            transition: 0.3s;
            cursor: pointer;
        }
        .sidebar a:hover {
            background: #f39c12;
        }

        .main-content {
            margin-left: 270px;
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 100vh;
        }

        .job-listings, .applied-jobs, .profile-section {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        .job-card, .applied-job-card, .profile-card {
            background: #ecf0f1;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .apply-btn, .remove-btn, .save-profile-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.3s;
        }
        .apply-btn {
            background: #3498db;
            color: white;
        }
        .apply-btn:hover {
            background: #2980b9;
        }
        .apply-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
        }
        .remove-btn {
            background: #e74c3c;
            color: white;
        }
        .remove-btn:hover {
            background: #c0392b;
        }
        .save-profile-btn {
            background: #2ecc71;
            color: white;
        }
        .save-profile-btn:hover {
            background: #27ae60;
        }

        .profile-photo {
            display: block;
            width: 100px;
            height: 100px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 10px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>Candidate Dashboard</h2>
        <a href="#" onclick="toggleSection('jobsContainer')">Available Jobs</a>
        <a href="#" onclick="toggleSection('appliedJobsContainer')">Applied Jobs</a>
        <a href="#" onclick="toggleSection('profileContainer')">Profile</a>
        <a href="{% url 'logout' %}">Logout</a>
    </div>

    <div class="main-content">
        <!-- Available Jobs -->
        <div id="jobsContainer" class="job-listings">
            <h3>Available Jobs</h3>
            <div id="availableJobs"></div>
        </div>

        <!-- Applied Jobs -->
        <div id="appliedJobsContainer" class="applied-jobs hidden">
            <h3>Applied Jobs</h3>
            <div id="appliedJobsList"></div>
        </div>

        <!-- Profile Section -->
        <div id="profileContainer" class="profile-section hidden">
            <h3>Profile</h3>
            <div class="profile-card">
                <label for="profilePhoto">
                    <img id="profileImage" src="{% static 'images/default-profile.png' %}" alt="Profile Photo" class="profile-photo">
                </label>
                <input type="file" id="profilePhoto" accept="image/*" onchange="previewProfilePhoto()" style="display: none;">

                <input type="text" id="fullName" placeholder="Full Name" style="display: block; width: 100%; margin-bottom: 10px;">
                <input type="email" id="email" placeholder="Email" style="display: block; width: 100%; margin-bottom: 10px;">
                <input type="tel" id="phone" placeholder="Phone Number" style="display: block; width: 100%; margin-bottom: 10px;">
                
                <label>Upload Resume:</label>
                <input type="file" id="resumeUpload" accept=".pdf,.doc,.docx" style="display: block; margin-bottom: 10px;">
                
                <button class="save-profile-btn" onclick="saveProfile()">Save Profile</button>
            </div>
        </div>
    </div>

    <script>
        let allJobs = [
            "Software Engineer at Google",
            "Data Scientist at Amazon",
            "Frontend Developer at Microsoft",
            "Backend Developer at Facebook",
            "AI Engineer at Tesla",
            "Cybersecurity Analyst at IBM",
            "Database Administrator at Oracle",
            "DevOps Engineer at Netflix",
            "UI/UX Designer at Adobe",
            "Cloud Engineer at AWS"
        ];

        document.addEventListener("DOMContentLoaded", function() {
            let appliedJobs = JSON.parse(localStorage.getItem("appliedJobs")) || [];
            updateAvailableJobsUI(appliedJobs);
            updateAppliedJobsUI(appliedJobs);
        });

        function applyJob(button, jobTitle) {
            let appliedJobs = JSON.parse(localStorage.getItem("appliedJobs")) || [];
            if (!appliedJobs.includes(jobTitle)) {
                appliedJobs.push(jobTitle);
                localStorage.setItem("appliedJobs", JSON.stringify(appliedJobs));
            }

            updateAvailableJobsUI(appliedJobs);
            updateAppliedJobsUI(appliedJobs);
        }

        function removeJob(jobTitle) {
            let appliedJobs = JSON.parse(localStorage.getItem("appliedJobs")) || [];
            appliedJobs = appliedJobs.filter(job => job !== jobTitle);
            localStorage.setItem("appliedJobs", JSON.stringify(appliedJobs));

            updateAvailableJobsUI(appliedJobs);
            updateAppliedJobsUI(appliedJobs);
        }

        function updateAvailableJobsUI(appliedJobs) {
            let availableJobsContainer = document.getElementById("availableJobs");
            availableJobsContainer.innerHTML = "";

            allJobs.forEach(job => {
                if (!appliedJobs.includes(job)) {
                    let jobCard = document.createElement("div");
                    jobCard.className = "job-card";
                    jobCard.innerHTML = `
                        <h3>${job}</h3>
                        <button class="apply-btn" onclick="applyJob(this, '${job}')">Apply Now</button>
                    `;
                    availableJobsContainer.appendChild(jobCard);
                }
            });
        }

        function updateAppliedJobsUI(appliedJobs) {
            let appliedJobsContainer = document.getElementById("appliedJobsList");
            appliedJobsContainer.innerHTML = appliedJobs.length
                ? appliedJobs.map(job => `
                    <div class="applied-job-card">
                        <h3>${job}</h3>
                        <button class="remove-btn" onclick="removeJob('${job}')">Remove</button>
                    </div>
                `).join("")
                : "<p>No applied jobs yet.</p>";
        }

        function toggleSection(sectionId) {
            document.querySelectorAll('.main-content > div').forEach(section => {
                section.classList.add("hidden");
            });
            document.getElementById(sectionId).classList.remove("hidden");
        }

        function previewProfilePhoto() {
            let file = document.getElementById("profilePhoto").files[0];
            if (file) {
                let reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById("profileImage").src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function saveProfile() {
            alert("Profile saved successfully!");
        }
    </script>

</body>
</html>
